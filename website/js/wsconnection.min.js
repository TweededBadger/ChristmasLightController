var socket;var joinedQueue=false;var inQ=0;var active=false;var joinedbefore=false;initSocket=function(){socket=io.connect("http://arcane-reaches-8269.herokuapp.com/");socket.on("pingback",function(b){inQ=b.queuelength;if(inQ==1){$("#queuelength").html(inQ+" person")}else{$("#queuelength").html(inQ+" people")}$("#startscreen").fadeIn();console.log(b);var a=Cookies.get("userid");console.log("COOKIE: "+a);a=undefined;if(a==undefined){}else{socket.emit("existinguser",a,function(d,c){if(!d){Cookies.set("userid",c.id);newuserdata(c);console.log(c)}else{console.log(c);newuserdata(c)}})}});socket.on("userstatus",function(a){newuserdata(a);debug("Q:"+a.queueposition,true);debug("a:"+a.active);debug("tl:"+a.timeleft)})};var sending=false;sendColorString=function(a){if(active&&!sending){sending=true;$("#btn_process").html("SENDING..");$("#speedmessage").fadeIn();socket.emit("userevent",{type:"colourstring",data:a},function(b){console.log(b);setTimeout(function(){$("#btn_process").html("SENT!");setTimeout(function(){$("#btn_process").html('SEND TO <span class="icon-christmastree"></span>')},1000);sending=false},5000)})}};newuserdata=function(b){$("#queuepos").html(b.queueposition+1);$(".timetogo").html(getTimeString(b.queuetimeleft+(b.queueposition*60*4000)));var a=Math.round(b.timeleft/1000);if(a<0){a=0}$("#timelefttxt").html(a+"");if(b.active){if(!active){active=true;$("#startscreen").stop().hide();$("#endscreen").stop().hide();$("#waitscreen").stop().hide();$("#creator").fadeIn();$("#container").addClass("create");if(!joinedbefore){joinedbefore=true;addcolour();addcolour()}}}else{if(active){active=false;joinedQueue=false;$("#creator").hide();$("#container").removeClass("create");$("#endscreen").delay(510).fadeIn()}}};joinQueue=function(){if(!joinedQueue){$("#startscreen").hide();$("#endscreen").hide();$("#waitscreen").delay(510).fadeIn();joinedQueue=true;socket.emit("newuser",function(a){console.log(a);Cookies.set("userid",a.id);newuserdata(a)})}};function getTimeString(f){var c=new Date(f);var g=c.getHours().toString();var e=c.getMinutes().toString();var h=c.getSeconds().toString();var d=Math.round(Number(c.getMilliseconds()/10)).toString();var a=e;if(a.length==1){a="0"+a}var i=h;if(i.length==1){i="0"+i}var b=d;if(b.length==1){b="0"+b}var f="";if(e>0){f+=e+" minute"}if(e>1){f+="s"}if(e>0){f+=" & "}if(h>0){f+=h+" second"}if(h>1){f+="s"}return f};